# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞: ID Mismatch

**Date:** 2026-01-03  
**Status:** CONFIRMED

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´ SQL –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò

**–®–∞–≥ 7 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- **party_id:** `11293ddb-6ac7-465b-bc18-ded62ce784f4` ‚úÖ –°—É—â–µ—Å—Ç–≤—É–µ—Ç
- **display_name:** `–ª—Ç–ª—Ç–ª–æ—Ç–ª`
- **company_id:** `ca0143be-0696-4422-b949-4f4119adef36` ‚úÖ –°–æ–≤–ø–∞–¥–∞–µ—Ç
- **party_type:** `company`
- **status:** `active`
- **note:** `This ID should work in GET endpoint`

---

## üéØ –ü–†–û–ë–õ–ï–ú–ê –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê

**Root Cause: ID Mismatch**

1. **ID –≤ URL:** `b0eb268e-a72c-43a5-a0c9-2ad2d2edf317`
   - –≠—Ç–æ ID –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `partner_party` ‚ùå

2. **GET endpoint –∏—â–µ—Ç:**
   ```sql
   SELECT * FROM party WHERE id = 'b0eb268e-a72c-43a5-a0c9-2ad2d2edf317';
   ```
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: 0 rows ‚ùå

3. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π ID:**
   ```sql
   SELECT * FROM party WHERE id = '11293ddb-6ac7-465b-bc18-ded62ce784f4';
   ```
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: 1 row ‚úÖ

---

## üîç –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´

### –í–∞—Ä–∏–∞–Ω—Ç 1: –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ID

**–§–∞–π–ª:** `app/api/directory/route.ts`

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–∏ —Å–ø–∏—Å–æ–∫ `party.id` –∏–ª–∏ `partner_party.id`?

**–ö–æ–¥:**
```typescript
const record = buildDirectoryRecord({
  ...party,
  ...
});
```

**buildDirectoryRecord –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:**
```typescript
id: row.id,  // ‚Üê –≠—Ç–æ party.id?
```

–ï—Å–ª–∏ `buildDirectoryRecord` –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ role —Ç–∞–±–ª–∏—Ü, `row.id` –º–æ–∂–µ—Ç –±—ã—Ç—å ID –∏–∑ `partner_party`, –∞ –Ω–µ –∏–∑ `party`!

### –í–∞—Ä–∏–∞–Ω—Ç 2: Frontend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ID –∏–∑ –¥—Ä—É–≥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

**–§–∞–π–ª:** `app/directory/page.tsx`

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** –û—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è ID –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏?

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

**–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `/api/directory` (—Å–ø–∏—Å–æ–∫)?
2. –ö–∞–∫–æ–π ID –∏—Å–ø–æ–ª—å–∑—É–µ—Ç frontend –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏?
3. –û—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è ID `b0eb268e-a72c-43a5-a0c9-2ad2d2edf317` –≤ URL?

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ —Å–ø–∏—Å–∫–∞ –∑–∞–ø–∏—Å–µ–π –∏ frontend –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.

---

**Created by:** ARCHITECT  
**Date:** 2026-01-03  
**Status:** Diagnosis confirmed, need to find source of wrong ID

