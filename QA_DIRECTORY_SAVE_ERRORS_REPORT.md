# QA Error Report - Directory Save Issues (Roles, Phone, Email)
**Date:** 2025-12-25  
**URL:** `http://localhost:3000/directory/9ee4c0f7-68e4-47a6-8d57-a7cc11f35582`  
**Branch:** `feat/directory-create`

---

## üîç –ü–†–û–ë–õ–ï–ú–´ –í–´–Ø–í–õ–ï–ù–´

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê #1: –†–æ–ª–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞–ø–∏—Å–∏
**Severity:** CRITICAL  
**Location:** `app/api/directory/[id]/route.ts` (—Å—Ç—Ä–æ–∫–∞ 245)

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–ª–∏–µ–Ω—Ç –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å —Ä–æ–ª—å—é `client`, –Ω–æ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `roles: []`
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–æ—Ä–º—É —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ä–æ–ª—å—é, —Ä–æ–ª—å –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- –§–æ—Ä–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏: "At least one role must be selected"

**–ü—Ä–∏—á–∏–Ω–∞:**
–í PUT endpoint –ø—Ä–∏ INSERT –≤ —Ç–∞–±–ª–∏—Ü—É `client_party` –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–µ–ø–æ–ª–Ω–æ:

```typescript
// app/api/directory/[id]/route.ts:259-267
if (updates.roles.includes("client")) {
  const { error: clientError } = await supabaseAdmin.from("client_party").insert({ 
    party_id: id,
    client_type: clientType 
  });
  if (clientError) {
    console.error("Error inserting client_party:", clientError);
    console.error("Attempted insert:", { party_id: id, client_type: clientType });
    // ‚ùå –û–®–ò–ë–ö–ê –ù–ï –í–û–ó–í–†–ê–©–ê–ï–¢–°–Ø –ö–õ–ò–ï–ù–¢–£ - –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ (200 OK)
  }
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–æ–¥ –≤–∫–ª—é—á–∞–µ—Ç `client_type` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–∞–Ω–µ–µ)
- –û—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞, –Ω–æ –ù–ï –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É
- –ï—Å–ª–∏ INSERT –ø–∞–¥–∞–µ—Ç, –∑–∞–ø—Ä–æ—Å –≤—Å–µ —Ä–∞–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200 OK, –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–Ω–∞–µ—Ç –æ –ø—Ä–æ–±–ª–µ–º–µ
- –†–æ–ª–∏ —É–¥–∞–ª—è—é—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 252-256), –Ω–æ –Ω–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ INSERT ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç: `roles: []`

**–ö–æ–¥ –ø—Ä–æ–±–ª–µ–º—ã:**
```typescript
// –¢–µ–∫—É—â–∏–π –∫–æ–¥ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):
if (updates.roles.includes("client")) {
  await supabaseAdmin.from("client_party").insert({ party_id: id });
}

// –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
if (updates.roles.includes("client")) {
  await supabaseAdmin.from("client_party").insert({ 
    party_id: id,
    client_type: updates.party_type || record.party_type // 'person' –∏–ª–∏ 'company'
  });
}
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å CREATE endpoint:**
–í `app/api/directory/create/route.ts` —Ä–æ–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Å—Ç—Ä–æ–∫–∞ ~170+), –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç–∞–º –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–ø–∏—Å–∏.

**–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä—ã—Ç—å `/directory/9ee4c0f7-68e4-47a6-8d57-a7cc11f35582`
2. –í—ã–±—Ä–∞—Ç—å —Ä–æ–ª—å `client`
3. –ù–∞–∂–∞—Ç—å "Save"
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API: `GET /api/directory/9ee4c0f7-68e4-47a6-8d57-a7cc11f35582` ‚Üí `roles: []`
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î: `SELECT * FROM client_party WHERE party_id = '9ee4c0f7-68e4-47a6-8d57-a7cc11f35582'` ‚Üí –∑–∞–ø–∏—Å–∏ –Ω–µ—Ç

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—ã —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ä–æ–ª—å—é, —Ä–æ–ª—å –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –ë–î
- API –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–µ–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ `roles`

**–í–µ—Ä–æ—è—Ç–Ω—ã–π —Ñ–∞–π–ª –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:**
- `app/api/directory/[id]/route.ts` (—Å—Ç—Ä–æ–∫–∏ 244-246)

---

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê #2: –¢–µ–ª–µ—Ñ–æ–Ω –∏ email –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
**Severity:** MAJOR  
**Location:** `app/api/directory/[id]/route.ts` (—Å—Ç—Ä–æ–∫–∏ 172-173)

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü—Ä–∏ –≤–≤–æ–¥–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ email –≤ —Ñ–æ—Ä–º–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏, –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—è –æ—Å—Ç–∞—é—Ç—Å—è –ø—É—Å—Ç—ã–º–∏

**–ü—Ä–∏—á–∏–Ω–∞:**
–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ –≤ API:

```typescript
// app/api/directory/[id]/route.ts:172-173
if (updates.email !== undefined) partyUpdates.email = (typeof updates.email === 'string' && updates.email.trim()) ? updates.email.trim() : null;
if (updates.phone !== undefined) partyUpdates.phone = (typeof updates.phone === 'string' && updates.phone.trim()) ? updates.phone.trim() : null;
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
–§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É `""` –¥–ª—è phone –∏ email (—Å—Ç—Ä–æ–∫–∏ 452-453 –≤ DirectoryForm.tsx):
```typescript
phone: phone.trim() || "", // Always include phone (empty string)
email: email.trim() || "", // Always include email (empty string)
```

–õ–æ–≥–∏–∫–∞ –≤ API –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞ (–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –≤ `null`), –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ —Ñ–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç phone/email –ø—Ä–∏ –∏—Ö –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏
2. –ù–µ—Ç –ª–∏ –ø—Ä–æ–±–ª–µ–º —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü—ã `party`

**–í–æ–∑–º–æ–∂–Ω–∞—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
–ï—Å–ª–∏ —Ñ–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç phone/email, –Ω–æ –æ–Ω–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è, –≤–æ–∑–º–æ–∂–Ω–æ:
- –û—à–∏–±–∫–∞ –ø—Ä–∏ UPDATE –≤ —Ç–∞–±–ª–∏—Ü–µ `party` (–Ω–æ –æ–Ω–∞ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –µ—Å–ª–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è)
- –ü—Ä–æ–±–ª–µ–º–∞ —Å RLS –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏
- –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö

**–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä—ã—Ç—å `/directory/9ee4c0f7-68e4-47a6-8d57-a7cc11f35582`
2. –í–≤–µ—Å—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω: `+371 12345678`
3. –í–≤–µ—Å—Ç–∏ email: `test@example.com`
4. –ù–∞–∂–∞—Ç—å "Save"
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API: `GET /api/directory/9ee4c0f7-68e4-47a6-8d57-a7cc11f35582` ‚Üí `phone: null, email: null`

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –¢–µ–ª–µ—Ñ–æ–Ω –∏ email –¥–æ–ª–∂–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –ë–î –ø—Ä–∏ –∏—Ö –≤–≤–æ–¥–µ

**–í–µ—Ä–æ—è—Ç–Ω—ã–π —Ñ–∞–π–ª –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:**
- `app/api/directory/[id]/route.ts` (—Å—Ç—Ä–æ–∫–∏ 172-173, 178-181)
- `components/DirectoryForm.tsx` (—Å—Ç—Ä–æ–∫–∏ 452-453) - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ INSERT —Ä–æ–ª–µ–π
**Severity:** MAJOR  
**Location:** `app/api/directory/[id]/route.ts` (—Å—Ç—Ä–æ–∫–∏ 244-268)

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∏ –ø—Ä–∏ INSERT –≤ —Ç–∞–±–ª–∏—Ü—ã —Ä–æ–ª–µ–π (`client_party`, `partner_party`, `subagents`) –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
- –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç, —á—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å

**–ö–æ–¥:**
```typescript
// app/api/directory/[id]/route.ts:244-246
if (updates.roles.includes("client")) {
  await supabaseAdmin.from("client_party").insert({ party_id: id });
  // ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—à–∏–±–æ–∫
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ï—Å–ª–∏ INSERT –≤ `client_party` –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è `client_type`), –æ—à–∏–±–∫–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –∏ –∑–∞–ø–∏—Å—å —Ä–æ–ª–∏ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è.

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç INSERT –∏ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏
- –í–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –µ—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–æ–ª–µ–π –Ω–µ —É–¥–∞–ª–æ—Å—å

---

## üìä –°–¢–ê–¢–£–° API –ó–ê–ü–†–û–°–û–í

**GET `/api/directory/9ee4c0f7-68e4-47a6-8d57-a7cc11f35582`:**
```json
{
  "record": {
    "id": "9ee4c0f7-68e4-47a6-8d57-a7cc11f35582",
    "display_name": "Katerina Mali≈°kina",
    "party_type": "person",
    "roles": [],  // ‚ùå –ü–£–°–¢–û–ô –ú–ê–°–°–ò–í (—Ä–æ–ª—å client –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å)
    "status": "active",
    "phone": null,  // ‚ö†Ô∏è NULL (–µ—Å–ª–∏ –±—ã–ª –≤–≤–µ–¥–µ–Ω, –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è)
    "email": null,  // ‚ö†Ô∏è NULL (–µ—Å–ª–∏ –±—ã–ª –≤–≤–µ–¥–µ–Ω, –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è)
    "title": "Mrs",
    "first_name": "Katerina",
    "last_name": "Mali≈°kina"
  }
}
```

---

## üîß –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ

### 1. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–æ–ª–µ–π

**–§–∞–π–ª:** `app/api/directory/[id]/route.ts`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è client role (—Å—Ç—Ä–æ–∫–∞ 259-267):**
```typescript
// –¢–ï–ö–£–©–ò–ô –ö–û–î (—á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π):
if (updates.roles.includes("client")) {
  const { error: clientError } = await supabaseAdmin.from("client_party").insert({ 
    party_id: id,
    client_type: clientType 
  });
  if (clientError) {
    console.error("Error inserting client_party:", clientError);
    // ‚ùå –û—à–∏–±–∫–∞ —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É
  }
}

// –î–û–õ–ñ–ù–û –ë–´–¢–¨:
if (updates.roles.includes("client")) {
  const { error: clientError } = await supabaseAdmin.from("client_party").insert({ 
    party_id: id,
    client_type: clientType 
  });
  if (clientError) {
    console.error("Error inserting client_party:", clientError);
    return NextResponse.json(
      { error: `Failed to save client role: ${clientError.message}` },
      { status: 500 }
    );
  }
}
```

**–¢–∞–∫–∂–µ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥–ª—è supplier –∏ subagent —Ä–æ–ª–µ–π:**
–î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è `partner_party` (—Å—Ç—Ä–æ–∫–∞ ~270+) –∏ `subagents` (—Å—Ç—Ä–æ–∫–∞ ~285+).

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
–ú–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å `party_type` –∏–∑ —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã `party` (–æ–Ω–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ä–∞–Ω—å—à–µ –≤ –∫–æ–¥–µ, —Å—Ç—Ä–æ–∫–∞ 178-181), –Ω–æ –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ.

### 2. –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è –≤—Å–µ—Ö —Ä–æ–ª–µ–π

–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è –≤—Å–µ—Ö INSERT –æ–ø–µ—Ä–∞—Ü–∏–π:
- `client_party` (—Å—Ç—Ä–æ–∫–∞ 245)
- `partner_party` (—Å—Ç—Ä–æ–∫–∞ 258)
- `subagents` (—Å—Ç—Ä–æ–∫–∞ 267)

### 3. –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ phone –∏ email

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
1. –û—Ç–∫—Ä—ã—Ç—å DevTools ‚Üí Network tab
2. –í–≤–µ—Å—Ç–∏ phone –∏ email –≤ —Ñ–æ—Ä–º–µ
3. –ù–∞–∂–∞—Ç—å Save
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PUT –∑–∞–ø—Ä–æ—Å ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å body (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å phone –∏ email)
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 200 OK)
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

–ï—Å–ª–∏ phone/email –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, –Ω–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `party`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î

---

## ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ù–´–ï –†–ê–ë–û–¢–ê–Æ–©–ò–ï –§–£–ù–ö–¶–ò–ò

- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ JavaScript
- ‚úÖ API endpoint GET –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –§–æ—Ä–º–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üìù –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **CODE WRITER:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å INSERT –≤ `client_party` - –¥–æ–±–∞–≤–∏—Ç—å `client_type` (–ö–†–ò–¢–ò–ß–ù–û)
2. **CODE WRITER:** –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è –≤—Å–µ—Ö INSERT –æ–ø–µ—Ä–∞—Ü–∏–π —Ä–æ–ª–µ–π
3. **QA:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ phone –∏ email –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª–µ–π
4. **QA:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ä–æ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

**Report Type:** Error Investigation  
**Priority:** HIGH (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ä–æ–ª–µ–π –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)

